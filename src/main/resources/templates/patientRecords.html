<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Podaci o Pacijentu</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

    
    <div class="collapse d-lg-none" id="sidebarMenu">
      <div class="bg-light p-3 mb-4">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link active" href="#">Početna</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="patientList.html">Popis pacijenata</a>
          </li>
        </ul>
        <a href="login.html" class="btn btn-outline-danger w-100">Odjavi se</a>
      </div>
    </div>
    
  <div class="container mt-5">
    <h3 class="mb-4">Podaci o Pacijentu</h3>
    <div id="patientDetails" class="card p-4">
      <p><strong>Ime i prezime:</strong> <span id="patientName"></span></p>
      <p><strong>Email:</strong> <span id="patientEmail"></span></p>
      <p><strong>Telefon:</strong> <span id="patientPhone"></span></p>
      <p><strong>Adresa:</strong> <span id="patientAddress"></span></p>
      <p><strong>Grad:</strong> <span id="patientCity"></span></p>
    </div>

    <h4 class="mt-4">Povijest Tlakova</h4>
    <table class="table table-striped mt-3">
      <thead>
        <tr>
          <th>#</th>
          <th>Datum i vrijeme</th>
          <th>Tlak i otkucaji</th>
          <th>Opis</th>
        </tr>
      </thead>
      <tbody id="pressureTable"></tbody>
    </table>

    <a href="patientList.html" class="btn btn-secondary mt-3">Natrag na popis pacijenata</a>
  </div>

  
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const pacijenti = JSON.parse(localStorage.getItem('pacijenti')) || [];
    const records = JSON.parse(localStorage.getItem('records')) || [];
    const selectedEmail = localStorage.getItem('selectedPatientEmail');

    console.log('selectedPatientEmail:', selectedEmail);
    console.log('pacijenti:', pacijenti);
    console.log('records:', records);

    if (selectedEmail) {
      const pacijent = pacijenti.find(p => p.email === selectedEmail);

      if (pacijent) {
        document.getElementById('patientName').textContent = `${pacijent.ime} ${pacijent.prezime}`;
        document.getElementById('patientEmail').textContent = pacijent.email;
        document.getElementById('patientPhone').textContent = pacijent.telefon || 'N/A';
        document.getElementById('patientAddress').textContent = pacijent.adresa || 'N/A';
        document.getElementById('patientCity').textContent = pacijent.grad || 'N/A';

        const pressureTable = document.getElementById('pressureTable');
        const patientRecords = records.filter(record => record.email === selectedEmail);

        if (patientRecords.length === 0) {
          pressureTable.innerHTML = '<tr><td colspan="4" class="text-center text-danger">Nema dostupnih zapisa tlaka za ovog pacijenta.</td></tr>';
        } else {
          patientRecords.forEach((record, index) => {
            const row = `
              <tr>
                <td>${index + 1}</td>
                <td>${record.datum}</td>
                <td>${record.tlak}</td>
                <td>${record.opis}</td>
              </tr>
            `;
            pressureTable.insertAdjacentHTML('beforeend', row);
          });
        }
      } else {
        document.getElementById('patientDetails').innerHTML = '<p class="text-danger">Podaci o pacijentu nisu pronađeni.</p>';
      }
    } else {
      document.getElementById('patientDetails').innerHTML = '<p class="text-danger">Nema odabranog pacijenta.</p>';
    }
  });
</script>

</body>
</html>
